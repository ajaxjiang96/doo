{% extends "base.html" %} {% block left %}
<div id={{event.id}} class="card event">
    <h3>{{event.owner}}'s</h3>
    <hr />
    <h1>
        {{event.title}}
        <div class="countdown">
            {% if event.finished %}
                <span class="countdownValue">
                    Passed
                </span>
            {% else %}
                <span class="countdownValue" hidden>
                    {{event.countdown}}
                </span>
                <span class="countdownDisplay">
                    {{event.countdown}}
                </span>
            {% endif %}
        </div>
    </h1>
    <div class="date">
        <h3>
            {{event.time.getFullYear()}}
            - {% if (event.time.getMonth() + 1) <= 9 %}0{{event.time.getMonth() + 1}}
            {% else %}{{event.time.getMonth() + 1}}
            {% endif %}
            - {% if (event.time.getDate()) <= 9 %}0{{event.time.getDate()}}
            {% else %}{{event.time.getDate()}}
            {% endif %}
            {% if event.type == "deadline" %}
                {% if event.time.getHours() <= 9 %}0{{event.time.getHours()}}
                {% else %}00{% endif %}:{% if event.time.getMinutes() <= 9 %}0{{event.time.getMinutes()}}
                {% else %}00{% endif %}
            {% endif %}
        </h3>
    </div>
    <div class="tags">
        <div class="tag">
            {{event.type}}
        </div>
        {% if event.finished %}
            <div class="tag">
                Passed
            </div>
        {% endif %}
        {% if new == event._id %}
            <div class="tag new">
                new
            </div>
        {% endif %}
    </div>
    <div class="interactions">
        <a class="action doComment" role="button">
            <span class="buttonText commentButtonText">
                        {{event.comments.length}} Comment{% if event.comments.length!=1 %}s{% endif%}
                    </span>
        </a>
        <a class="action doPlus1 {% if user.username in event.liked%}liked{% endif%}" role="button">
            <!-- <img class="likeIcon" src="{% if user.username in event.liked%}images/like.svg{% else %}images/liked.svg{% endif %}" /> -->
            <span class="buttonText plus1ButtonText">
                         {% if event.value < 999 %}{{event.value}}{% else%}999+{% endif %}
                     </span>
        </a>
    </div>
    {% if user.username %}
    <div class="singleCommentBar">
        <form class="commentEntry" action="/comment" method="post">
            <input name="content" type="text" placeholder="New Comment" required/>
            <button class="sendButton" type="submit">Send</button>
            <input name="event" value={{event.id}} hidden/>
        </form>
    </div>
    {% endif %}
    <div id="comments">
        {% for comment in commentList %}
        <div id={{comment.id}} class="comment animate-opacity">
            <span class="commentOwner"><strong>{{comment.owner}}: </strong></span>{{comment.content}}
            <span class="timestamp">
                    {{comment.timestamp.getFullYear()}}-{{comment.timestamp.getMonth() + 1}}-{{comment.timestamp.getDate()}} {{comment.timestamp.getHours()}}:{{comment.timestamp.getMinutes()}}
                </span>
            {% if session.event_owner == session.username %}
            <a class="action deleteComment" role="button"><span class="buttonText">Delete<span></a>
            <!-- <button class="deleteComment">Delete</button> -->
            {% elif comment.owner == session.username %}
            <a class="action deleteComment" role="button"><span class="buttonText">Delete<span></a>
            <!-- <button class="deleteComment">Delete</button> -->
            {% endif %}
        </div>
        {% endfor %}
        <div id="commentPlaceholder" class="comment placeholder animate-opacity">
            Oops, no more comments. Do say something about this event!
        </div>
    </div>
</div>
{% endblock %}
